<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>ğŸ¥ Watch & Earn</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: sans-serif;
      background: #f3f3f3;
      padding: 20px;
      direction: rtl;
    }
    h2 {
      text-align: center;
      margin-bottom: 25px;
    }
    .video-block {
      background: #fff;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    .video-block a {
      display: block;
      margin-bottom: 10px;
      color: #007bff;
      text-decoration: none;
    }
    input, button {
      width: 100%;
      padding: 10px;
      margin-top: 8px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    button {
      background-color: #28a745;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    button:disabled {
      background-color: #aaa;
    }
    .msg {
      margin-top: 8px;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h2>ğŸ¥ ÙˆÛŒØ¯ÛŒÙˆ Ø¨Ø¨ÛŒÙ†ØŒ Ø¬Ø§ÛŒØ²Ù‡ Ø¨Ú¯ÛŒØ±</h2>
<div id="videoContainer"></div>

<script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
<script>
  // âœ… ÙÙ‚Ø· Ø®ÙˆØ¯Øª Ø§ÛŒÙ†Ø¬Ø§ ÙˆÛŒØ¯ÛŒÙˆÙ‡Ø§ Ùˆ Ø¬ÙˆØ§Ø¨â€ŒÙ‡Ø§ Ø±Ùˆ ÙˆØ§Ø±Ø¯ Ú©Ù†
  const videoQuestions = [
    { id: 1, url: "https://www.youtube.com/watch?v=abc123", answer: "legend" },
    { id: 2, url: "https://www.youtube.com/watch?v=def456", answer: "crypto" }
  ];

  const userAnswers = JSON.parse(localStorage.getItem("userAnswers") || "{}");
  const container = document.getElementById("videoContainer");

  videoQuestions.forEach(video => {
    const isAnswered = userAnswers[video.id];
    container.innerHTML += `
      <div class="video-block" id="block-${video.id}">
        <a href="${video.url}" target="_blank">ğŸ¬ Ø¯ÛŒØ¯Ù† ÙˆÛŒØ¯ÛŒÙˆ ${video.id}</a>
        <input type="text" id="input-${video.id}" placeholder="Ú©Ù„Ù…Ù‡â€ŒØ§ÛŒ Ú©Ù‡ Ø¯ÛŒØ¯ÛŒ Ø±Ùˆ Ø¨Ù†ÙˆÛŒØ³" ${isAnswered ? "disabled" : ""}>
        <button onclick="submitAnswer(${video.id})" ${isAnswered ? "disabled" : ""}>Ø§Ø±Ø³Ø§Ù„ Ù¾Ø§Ø³Ø®</button>
        <div class="msg" id="msg-${video.id}">${isAnswered ? "Ù‚Ø¨Ù„Ø§Ù‹ Ù¾Ø§Ø³Ø® Ø¯Ø§Ø¯ÛŒ." : ""}</div>
      </div>
    `;
  });

  const tokenAddress = "0xYourTokenAddress";  // Ø¢Ø¯Ø±Ø³ ØªÙˆÚ©Ù†Øª
  const rewardAmount = "35000000000000000";   // Ù…Ø¹Ø§Ø¯Ù„ 0.035 ØªÙˆÚ©Ù† (Ø¨Ø§ 18 Ø±Ù‚Ù… Ø§Ø¹Ø´Ø§Ø±)

  const tokenABI = [
    {
      "constant": false,
      "inputs": [
        { "name": "_to", "type": "address" },
        { "name": "_value", "type": "uint256" }
      ],
      "name": "transfer",
      "outputs": [{ "name": "", "type": "bool" }],
      "type": "function"
    }
  ];

  async function submitAnswer(id) {
    const input = document.getElementById(`input-${id}`);
    const msg = document.getElementById(`msg-${id}`);
    const userInput = input.value.trim().toLowerCase();
    const correctAnswer = videoQuestions.find(v => v.id === id).answer.toLowerCase();

    if (!userInput) return alert("Ù„Ø·ÙØ§Ù‹ Ù¾Ø§Ø³Ø® Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†");

    if (userInput === correctAnswer) {
      if (typeof window.ethereum === "undefined") return alert("Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù…ØªØ§Ù…Ø³Ú© Ù†ØµØ¨ Ù†ÛŒØ³Øª");

      try {
        const accounts = await window.ethereum.request({ method: "eth_requestAccounts" });
        const user = accounts[0];
        const web3 = new Web3(window.ethereum);
        const tokenContract = new web3.eth.Contract(tokenABI, tokenAddress);

        await tokenContract.methods.transfer(user, rewardAmount).send({ from: user });

        msg.innerText = "âœ… Ù¾Ø§Ø³Ø® ØµØ­ÛŒØ­ Ø¨ÙˆØ¯! ØªÙˆÚ©Ù† Ø¨Ø±Ø§Øª ÙØ±Ø³ØªØ§Ø¯Ù‡ Ø´Ø¯.";
        input.disabled = true;
        input.nextElementSibling.disabled = true;

        userAnswers[id] = true;
        localStorage.setItem("userAnswers", JSON.stringify(userAnswers));

      } catch (err) {
        console.error(err);
        msg.innerText = "âŒ Ù…Ø´Ú©Ù„ÛŒ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„ Ù¾Ø§Ø¯Ø§Ø´ Ù¾ÛŒØ´ Ø¢Ù…Ø¯.";
      }
    } else {
      msg.innerText = "âŒ Ù¾Ø§Ø³Ø® Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª!";
    }
  }
</script>

</body>
</html>
